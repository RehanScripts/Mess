<!DOCTYPE html>
<html lang="en">
<head>
    
   
    <title>Login Page</title>

    <link rel="stylesheet" href="style.css">
</head>

<body>
    
    <form id="loginForm"><center> <h2>SMART MESS MANAGEMENT SYSTEM</h2></center>
<br>
        <p> Username : <input type="text" id="username" name="username" placeholder="Enter your username" required></p>
        <br>
        <p> Password : <input type="password" id="password" name="password" placeholder="Enter your password" required></p>
        <br>
     <center> <div class="options">
        <label><input type="checkbox"> Remember me</label>
        <a href="#">Forgot password?</a>
</div></center>
        <br>
        <center><button type="submit">Login</button></center> 

<br>
<center> Not Registered?  <a href="signup.html">Sign up</a></center> 
<br>
<center>
    <button type="button" id="adminModeToggle" style="padding:6px 10px; border:1px solid #d1d5db; border-radius:6px; background:#f3f4f6; cursor:pointer;">Admin Login</button>
    <div id="adminHint" style="display:none; font-size:12px; color:#374151; margin-top:6px;">Admin mode enabled. Use your admin credentials.</div>
    <div id="adminError" style="display:none; font-size:12px; color:#b91c1c; margin-top:6px;">Only admin users can access the admin dashboard.</div>
  
  
</center>

     </form>

<script>
// Intercept the form submit and send credentials to the backend
document.getElementById('loginForm').addEventListener('submit', async function (e) {
    e.preventDefault();
    const username = document.getElementById('username').value || '';
    const password = document.getElementById('password').value || '';

    try {
        const res = await fetch('/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
        });
        const data = await res.json();
        if (data && data.success) {
            const role = data.user && data.user.role;
            if (role === 'admin') {
                window.location.href = 'admin_dashboard.html';
            } else {
                window.location.href = 'dashboard.html';
            }
        } else {
            alert('Login failed: ' + (data && data.error ? data.error : 'unknown_error'));
        }
    } catch (err) {
    console.error(err);
    alert('Server error. Please try again.');
    }
});

// Admin mode toggle (no prefilled credentials)
(function(){
  const toggleBtn = document.getElementById('adminModeToggle');
  const adminHint = document.getElementById('adminHint');
  const adminErr = document.getElementById('adminError');
  const heading = document.querySelector('#loginForm h2');
  const userInput = document.getElementById('username');
  const passInput = document.getElementById('password');
  let adminMode = false;

  if (toggleBtn) {
    toggleBtn.addEventListener('click', () => {
      adminMode = !adminMode;
      toggleBtn.textContent = adminMode ? 'User Login' : 'Admin Login';
      if (heading) heading.textContent = adminMode ? 'ADMIN LOGIN' : 'SMART MESS MANAGEMENT SYSTEM';
      if (userInput) userInput.placeholder = adminMode ? 'Enter admin username' : 'Enter your username';
      if (passInput) passInput.placeholder = adminMode ? 'Enter admin password' : 'Enter your password';
      adminHint.style.display = adminMode ? 'block' : 'none';
      adminErr.style.display = 'none';
    });
  }
})();
</script>
</body>
</html>